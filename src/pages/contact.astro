---
import Base from '../layouts/Base.astro';
---

<Base title="Contact - Strannik">
	<style>
		.contact-layout {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 4rem;
			align-items: start;
		}

		.contact-intro h1 {
			font-size: 1.8rem;
			font-weight: 600;
			margin-bottom: 1.5rem;
		}

		.contact-intro p {
			color: #666;
			font-size: 1.1rem;
			line-height: 1.7;
			margin-bottom: 1rem;
		}

		.contact-form {
			display: flex;
			flex-direction: column;
			gap: 1.5rem;
		}

		.form-group {
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
		}

		.form-group label {
			font-size: 0.9rem;
			color: #666;
		}

		.form-group input,
		.form-group textarea {
			padding: 0.75rem 1rem;
			border: 1px solid #e5e5e5;
			border-radius: 4px;
			font-family: inherit;
			font-size: 1rem;
			background: #fafafa;
		}

		.form-group input:focus,
		.form-group textarea:focus {
			outline: none;
			border-color: #999;
			background: #fff;
		}

		.form-group textarea {
			min-height: 150px;
			resize: vertical;
		}

		.form-group input::placeholder,
		.form-group textarea::placeholder {
			color: #999;
		}

		.submit-btn {
			align-self: flex-start;
			padding: 0.75rem 1.5rem;
			background: #000;
			color: #fff;
			border: none;
			border-radius: 4px;
			font-family: inherit;
			font-size: 1rem;
			cursor: pointer;
		}

		.submit-btn:hover {
			background: #333;
		}

		.submit-btn:disabled {
			background: #666;
			cursor: not-allowed;
		}

		.form-status {
			font-size: 0.9rem;
			color: #666;
		}

		.form-status.success {
			color: #2e7d32;
		}

		.form-status.error {
			color: #c62828;
		}

		@media (max-width: 768px) {
			.contact-layout {
				grid-template-columns: 1fr;
				gap: 2rem;
			}
		}
	</style>

	<div class="contact-layout">
		<div class="contact-intro">
			<h1>Get in touch</h1>
			<p>Have a question, suggestion, or found a bug? Send a message and I'll get back to you.</p>
			<p>For bug reports and feature requests, you can also open an issue on GitHub.</p>
		</div>

		<form class="contact-form" id="contact-form">
			<div class="form-group">
				<label for="name">Name</label>
				<input type="text" id="name" name="name" placeholder="Your name" required />
			</div>

			<div class="form-group">
				<label for="email">Email</label>
				<input type="email" id="email" name="email" placeholder="your@email.com" required />
			</div>

			<div class="form-group">
				<label for="message">Message</label>
				<textarea id="message" name="message" placeholder="What's on your mind?" required></textarea>
			</div>

			<button type="submit" class="submit-btn">Send</button>
			<p class="form-status" id="form-status"></p>
		</form>
	</div>

	<script>
		document.getElementById('contact-form')?.addEventListener('submit', async (e) => {
			e.preventDefault();
			const form = e.target;
			const status = document.getElementById('form-status');
			const btn = form.querySelector('button');

			const name = form.name.value;
			const email = form.email.value;
			const message = form.message.value;

			btn.disabled = true;
			btn.textContent = 'Sending...';
			status.textContent = '';
			status.className = 'form-status';

			try {
				const res = await fetch('/api/contact', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify({ name, email, message })
				});
				const data = await res.json();

				if (res.ok) {
					status.textContent = 'Message sent. Thanks for reaching out!';
					status.classList.add('success');
					form.reset();
				} else {
					status.textContent = data.error || 'Something went wrong';
					status.classList.add('error');
				}
			} catch {
				status.textContent = 'Network error. Please try again.';
				status.classList.add('error');
			}

			btn.disabled = false;
			btn.textContent = 'Send';
		});
	</script>
</Base>
