---
import DocsLayout from '../../../layouts/DocsLayout.astro';

const sidebar = [
	{
		links: [
			{ href: '/docs/prismchart', label: 'Intro' },
			{ href: '/docs/prismchart/foundation', label: 'Foundation' },
			{ href: '/docs/prismchart/chart-tools', label: 'Chart Tools' },
			{ href: '/docs/prismchart/layers', label: 'Layers', active: true },
			{ href: '/docs/prismchart/customization', label: 'Customization' },
			{ href: '/docs/prismchart/presentation', label: 'Presentation' },
			{ href: '/docs/prismchart/alerts', label: 'Alerts' },
			{ href: '/docs/prismchart/shortcuts', label: 'Shortcuts' }
		]
	},
	{
		title: 'Drawing Tools',
		collapsible: true,
		links: [
			{ href: '/docs/prismchart/drawing-tools-1', label: 'Drawing Tools 1' },
			{ href: '/docs/prismchart/drawing-tools-2', label: 'Drawing Tools 2' },
			{ href: '/docs/prismchart/drawing-tools-3', label: 'Drawing Tools 3' }
		]
	},
	{
		title: 'Analysis Tools',
		collapsible: true,
		links: [
			{ href: '/docs/prismchart/quick-tools', label: 'Quick Tools' },
			{ href: '/docs/prismchart/time-context', label: 'Time Context' }
		]
	},
	{
		title: 'Portability',
		collapsible: true,
		links: [
			{ href: '/docs/prismchart/save-export', label: 'Save & Export' },
			{ href: '/docs/prismchart/copy-paste', label: 'Copy/Paste' }
		]
	},
	{
		title: 'Development',
		collapsible: true,
		links: [
			{ href: '/docs/prismchart/building', label: 'Building' },
			{ href: '/docs/prismchart/changelog', label: 'Changelog' },
			{ href: '/docs/prismchart/credits', label: 'Credits' }
		]
	}
];

const toc = [
	{ href: '#layers', label: 'Layers' },
	{ href: '#drawing-manager', label: 'Drawing Manager' },
	{ href: '#sublayer-system', label: 'Sublayer System' },
	{ href: '#naming', label: 'Naming' }
];
---

<DocsLayout title="Layers - PrismChart - Docs" sidebar={sidebar} toc={toc} issuesUrl="https://github.com/ether-strannik/PrismChart/issues">
	<style>
		h1 {
			font-size: 1.8rem;
			font-weight: 600;
			margin-bottom: 0.5rem;
		}

		.tagline {
			color: #666;
			margin-bottom: 2rem;
		}

		h2 {
			font-size: 1.2rem;
			font-weight: 600;
			margin: 2rem 0 1rem;
			padding-bottom: 0.5rem;
			border-bottom: 1px solid #e5e5e5;
		}

		.section-intro {
			font-weight: 500;
			color: #000;
			margin-bottom: 1rem;
		}

		code {
			background: #f0f0f0;
			padding: 0.2rem 0.4rem;
			border-radius: 3px;
			font-size: 0.9rem;
		}

		p {
			color: #333;
			margin-bottom: 1rem;
		}

		ul {
			padding-left: 1.5rem;
			margin-bottom: 1.5rem;
		}

		li {
			padding: 0.3rem 0;
			color: #333;
		}

		.video-container {
			margin-bottom: 2rem;
			border-radius: 8px;
			overflow: hidden;
		}

		.video-container iframe {
			display: block;
			width: 100%;
			aspect-ratio: 16/9;
			border: none;
		}

	</style>

	<h1>Layers</h1>
	<p class="tagline">Object management and organization</p>

	<div class="video-container" id="video">
		<div id="yt-player"></div>
	</div>

	<script>
		function initYouTubePlayer() {
			const container = document.getElementById('yt-player');
			if (!container || container.hasChildNodes()) return;

			new YT.Player('yt-player', {
				videoId: 'thaZxw8F15o',
				playerVars: { rel: 0, modestbranding: 1 },
				events: {
					onReady: function(e) { e.target.setPlaybackQuality('hd720'); }
				}
			});
		}

		document.addEventListener('astro:page-load', () => {
			if (typeof YT !== 'undefined' && YT.Player) {
				initYouTubePlayer();
			} else {
				const tag = document.createElement('script');
				tag.src = 'https://www.youtube.com/iframe_api';
				document.head.appendChild(tag);
				window.onYouTubeIframeAPIReady = initYouTubePlayer;
			}
		});
	</script>

	<h2 id="layers">Layers</h2>
	<p class="section-intro">Group your drawings by purpose.</p>
	<p>Every object in PrismChart belongs to a layer, determined by its naming prefix. An object named <code>FVG_001</code> belongs to the FVG layer. <code>OB_entry</code> belongs to OB. This simple convention keeps your chart organized as analysis accumulates.</p>
	<p>Create and manage layers through the Manage Groups dialog. When drawing, select your target layer from the dropdown - the object will be named automatically with the layer prefix and a sequential number.</p>
	<p>Objects without a recognized prefix appear in an optional "Ungrouped" layer.</p>

	<h2 id="drawing-manager">Drawing Manager</h2>
	<p class="section-intro">Control visibility and access from one panel.</p>
	<p>The Drawing Manager lists all objects organized by layer. Expand or collapse layers to focus on what matters. Toggle visibility or lock state per layer or per individual object. Delete objects with confirmation dialogs to prevent accidents.</p>
	<p>Layers can be reordered by dragging. The panel auto-refreshes when chart objects change, keeping the list current without manual intervention.</p>

	<h2 id="sublayer-system">Sublayer System</h2>
	<p class="section-intro">Keep complex objects together.</p>
	<p>Some drawings consist of multiple parts - a position tool has entry, stop loss, and take profit lines. PrismChart auto-detects these relationships through naming convention: <code>POS_001_entry</code>, <code>POS_001_sl</code>, <code>POS_001_tp1</code> are recognized as parts of the same object.</p>
	<p>Sublayers collapse under their parent in the Drawing Manager. Lock, hide, or delete the parent and all sub-objects follow. A mixed-state indicator shows when sub-objects have different visibility or lock states.</p>

	<h2 id="naming">Naming</h2>
	<p class="section-intro">Name objects your way.</p>
	<p>After drawing, a naming dialog appears where you can enter a custom name or accept the auto-generated one. Names follow the pattern <code>[LAYER]_001</code>, <code>[LAYER]_002</code>, incrementing automatically.</p>
	<p>To rename an existing object, click the rename button in the layer panel. The rename dialog includes a group dropdown, letting you move objects between layers by changing their prefix.</p>
</DocsLayout>
